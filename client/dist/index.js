var main;(()=>{"use strict";var e={d:(t,s)=>{for(var o in s)e.o(s,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:s[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Feeds:()=>s,Token:()=>o,Users:()=>a,userFormCheck:()=>n});class s{constructor(e){this.token=e}async select(e,t){let s=new URLSearchParams(t||{}).toString();return(await fetch(`/api/feeds/${e}?${s}`,{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded","x-access-token":this.token}})).json()}async insert(e){return(await fetch("/api/feeds",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","x-access-token":this.token},body:`content="${e}"`})).json()}async delete(e){return(await fetch("/api/feeds/"+e,{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded","x-access-token":this.token}})).json()}async update(e,t){return(await fetch("/api/feeds/"+e,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","x-access-token":this.token},body:`content=${t}`})).json()}}class o{constructor(){}get(e){let t=e+"=",s="";const o=document.cookie.split(";");for(let e=0;e<o.length;e++)if(" "===o[e][0]&&(o[e]=o[e].substring(1)),0===o[e].indexOf(t))return s=o[e].slice(t.length,o[e].length),s;return s}check(e){try{return{is_vaild:1,decoded:JSON.parse(atob(e.split(".")[1]))}}catch(e){return{is_vaild:0}}}}class a{constructor(){this.token=new o}async signup(){try{let e=btoa(document.querySelector("#Username").value),t=btoa(document.querySelector("#Password").value),s=btoa(document.querySelector("#Email").value);if(""==e||""==t||""==s)return dds.toast({content:"입력칸을 확인해주세요"});let o=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`user_id=${e}&user_pw=${t}&user_email=${s}`}),a=await o.json();1==a.status?(Cookies.set("user",a.token),dds.toast({content:"가입에 성공했어요"}),setTimeout((()=>{location.href="/"}),1200)):2==a.status?dds.toast({content:"바밀번호는 8자리 이상이여야 해요"}):5==a.status?dds.toast({content:"아이디에 특수문자는 입력할 수 없어요"}):0==a.status&&dds.toast({content:"사용 불가한 아이디 또는 이메일이에요"})}catch(e){dds.toast({content:"에러가 발생했어요"})}}async login(){let e=btoa(document.querySelector("#Username").value),t=btoa(document.querySelector("#Password").value),s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`user_id="${e}"&user_pw="${t}"`}),o=await s.json();1==o.status?(Cookies.set("user",o.token),dds.toast({content:"로그인에 성공했어요"}),setTimeout((()=>{location.href="/"}),1400)):-1==o.status?dds.toast({content:"탈퇴한 회원이거나 권한이 없어요"}):dds.toast({content:"로그인 정보가 맞지 않아요"})}async delete(){let e=token.check(token.get("user")).decoded.user_id,t=await fetch("/api/users/"+e,{method:"DELETE",headers:{"Content-Type":"application/x-www-form-urlencoded","x-access-token":this.token.get("user")}}),s=await t.json();1==s.status?(dds.toast({content:"정상적으로 탈퇴를 완료했어요"}),setTimeout((()=>{location.href="/"}),1200)):-1==s.status?dds.toast({content:"탈퇴 권한이 없어요"}):dds.toast({content:"탈퇴에 실패했어요"})}async update(e,t){let s=await fetch("/api/users/"+e,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","x-access-token":this.token.get("user")},body:`user_name=${t.name}`});return await s.json()}async get(e){let t=await fetch("/api/users/"+e,{method:"GET",headers:{"x-access-token":this.token.get("user")}});return await t.json()}async checkAuth(){let e=await fetch("/api/auth/me",{method:"GET",headers:{"x-access-token":this.token.get("user")}});return await e.json()}async logout(){try{document.cookie="user=; expires=Thu, 01 Jan 1999 00:00:10 GMT;",location.href="/"}catch(e){return 0}}}const n={switchValidMessage:function(e,t){t?(e.classList.add("is-valid"),e.classList.remove("is-invalid")):(e.classList.add("is-invalid"),e.classList.remove("is-valid"))},checkId:function(){let e=document.querySelector("#Username");1==/[^\w]/.test(String(e.value))||""==e.value?main.userFormCheck.switchValidMessage(e,!1):main.userFormCheck.switchValidMessage(e,!0)},checkPassword:function(){let e=document.querySelector("#Password");e.value.length<8?main.userFormCheck.switchValidMessage(e,!1):main.userFormCheck.switchValidMessage(e,!0)},checkEmail:function(){let e=document.querySelector("#Email");0==/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(String(e.value))?main.userFormCheck.switchValidMessage(e,!1):main.userFormCheck.switchValidMessage(e,!0)}};main=t})();